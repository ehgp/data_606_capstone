<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Report &mdash;  Realtime Crypto Arbitrage Bot 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="User Guide" href="user_guide.html" />
    <link rel="prev" title="Realtime Crypto Arbitrage Bot" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home">  Realtime Crypto Arbitrage Bot
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Realtime Crypto Arbitrage Bot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#disclosure">Disclosure</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#support">Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#todo">TODO</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Report</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#abstract">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-a-crypto-trading-arbitrage-bot">What is a Crypto Trading/Arbitrage Bot?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters-of-our-triangular-arbitrage-bot">Parameters of Our Triangular Arbitrage Bot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dataset">Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exploratory-data-analysis">Exploratory data analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#price-prediction-with-time-series-analysis">Price Prediction with Time Series Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#how-does-our-bot-work">How does our bot work?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kucoinlive-py">Kucoinlive.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-py">Analysis.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trade-py">Trade.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-flow-for-this-project">Data Flow for This Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results-of-the-triangular-arbitrage-model">Results of the Triangular Arbitrage Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#bellman-ford-algorithm">Bellman-Ford Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-the-results-of-the-models">Comparing the Results of the Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion-and-future-work">Conclusion and Future Work</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kucoinlive.html">kucoinlive</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="coinbaselive.html">coinbaselive</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="geminilive.html">geminilive</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">analysis</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="trade.html">trade</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="triarb.html">triarb</a><ul>
<li class="toctree-l3"><a class="reference internal" href="triarb.html#notes">NOTES</a></li>
<li class="toctree-l3"><a class="reference internal" href="triarb.html#forward-arbitrage-ex-ethbtc-a-usdt-b-eth-c-btc">FORWARD ARBITRAGE (EX: ETHBTC) -&gt; a = USDT, b = ETH, c = BTC</a></li>
<li class="toctree-l3"><a class="reference internal" href="triarb.html#reverse-arbitrage-ex-ethbtc-a-usdt-b-eth-c-btc">REVERSE ARBITRAGE (EX: ETHBTC) -&gt; a = USDT, b = ETH, c = BTC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bellmanford.html">bellmanford</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html"> Realtime Crypto Arbitrage Bot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Report</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="report">
<h1>Report<a class="headerlink" href="#report" title="Permalink to this headline"></a></h1>
<ul class="simple">
<li><p><a class="reference external" href="#report">Report</a></p>
<ul>
<li><p><a class="reference external" href="#abstract">Abstract</a></p></li>
<li><p><a class="reference external" href="#introduction">Introduction</a></p>
<ul>
<li><p><a class="reference external" href="#what-is-a-crypto-tradingarbitrage-bot">What is a Crypto Trading/Arbitrage Bot?</a></p></li>
<li><p><a class="reference external" href="#parameters-of-our-triangular-arbitrage-bot">Parameters of Our Triangular Arbitrage Bot</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#dataset">Dataset</a></p>
<ul>
<li><p><a class="reference external" href="#exploratory-data-analysis">Exploratory data analysis</a></p></li>
<li><p><a class="reference external" href="#price-prediction-with-time-series-analysis">Price Prediction with Time Series Analysis</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#how-does-our-bot-work">How does our bot work?</a></p>
<ul>
<li><p><a class="reference external" href="#kucoinlivepy">Kucoinlive.py</a></p></li>
<li><p><a class="reference external" href="#analysispy">Analysis.py</a></p></li>
<li><p><a class="reference external" href="#tradepy">Trade.py</a></p></li>
<li><p><a class="reference external" href="#data-flow-for-this-project">Data Flow for This Project</a></p></li>
<li><p><a class="reference external" href="#results-of-the-triangular-arbitrage-model">Results of the Triangular Arbitrage Model</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#bellman-ford-algorithm">Bellman-Ford Algorithm</a></p></li>
<li><p><a class="reference external" href="#comparing-the-results-of-the-models">Comparing the Results of the Models</a></p></li>
<li><p><a class="reference external" href="#conclusion-and-future-work">Conclusion and Future Work</a></p></li>
<li><p><a class="reference external" href="#references">References</a></p></li>
</ul>
</li>
</ul>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline"></a></h2>
<p>The purpose of this study is to create a crypto arbitrage bot which allows users to execute automated trades. Triangular arbitrage is chosen as the arbitrage method, so the aim is to take advantage of the price differences between three different pairs. Kucoin is the chosen exchange for this project. The Bellman-Ford algorithm is also used as a second arbitrage model, which computes the shortest path in a single source vortex.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>Arbirtrage is buying an asset on an exchange and selling it at another exchange for a higher price. It is a very straightforward process for traders. When a stock’s price is lower on a foreign exchange, traders buy it from there and sell it on the local exchange. The price on the foreign exchange is considered “undervalued” because there are delays in adjusting the prices on different exchanges. However, detecting arbitrage opportunities is a very hard work, and taking advantage of them is even harder. Trading arbitrage opportunities manually is near impossible because they occur and dissappear in seconds. For that reason, it requires advanced programs and computer equipments to automate this process. There are already numerous programs in every exchange which try to take advantage from these discrepancies. There are different types of arbitrages, such as pure arbitrage, merger arbitrage, triangular arbitrage, etc. In this project, triangular arbitrage is studied and applied in crypto market. If a price disparity between three foreign currencies happens when their exchange rates do not exactly line up, resulting in triangular arbitrage. In other words, triangular arbitrage exploits market inefficiencies, and help market to become efficient. Below example shows how the triangular arbitrage works between the fiat currencies EUR, USD, and GBP.</p>
<p>Example for triangular arbitrage:
Suppose you have $1 million, and you are provided with the following exchange rates: EUR/USD = 1.1586, EUR/GBP = 1.4600, and USD/GBP = 1.6939. With these exchange rates there is an arbitrage opportunity:
Sell dollars to buy euros: $1 million ÷ 1.1586 = €863,110
Sell euros for pounds: €863,100 ÷ 1.4600 = £591,171
Sell pounds for dollars: £591,171 x 1.6939 = $1,001,384
Subtract the initial investment from the final amount: $1,001,384 – $1,000,000 = $1,384
From these transactions (assuming no transaction costs or taxes), you would receive an arbitrage profit of $1,384 (<em>What Is Triangular Arbitrage?</em>, 2021).</p>
<p>Triangular arbitrage is widely studied before from different aspects mostly in foreign exchange trading platforms. People practice triangular arbitrage between fiat currencies like the example above. While the analysis of Aloosh and Bekaert (2017) aims at controlling for the triangular arbitrage, our project tries to charactrize and take advantage from arbitrage opportunities. Another research from Piccotti (2018) uses 5-minute period in his quote revisions, while our project tries to detect arbitrage opportunities in milliseconds. Speed is important while trading arbitrage, but in crypto world it is even more essential. The crypto market’s volatility is extremely higher than foreign exchange market, thus working with shorter time intervals is necessary. Another constraint to trade arbitrage is the number of opportunities over the years. According to the examination of time series data from 1999 to 2009, a decrease has been found in the number of triangle arbitrage possibilities (Ito, 2012). This is expected and can be normalized because the market becomes more efficient over the years with the advancement of the technology. However, it is never perfect, so there is still room for users to take advantage from price discrepencies.</p>
<p>There has been much research about market discrepancies and arbitrage trading. Different methods and various types of models have been used to trade arbitrage opportunities. Gebarowski et al. (2019) aimed to show the prediction power of q-detrended cross-correlation coefficient stemming when it is practiced over historical time series of exchange rates for certain currencies in their research. They investigated how financial markets create arbitrage opportunities by analyzing the delicacy of different statistical properties. Another study from Lin et al. (2011) analyzed cross-correlations in the stock exchange via using time-delay variant of DCCA (detrended cross-correlation analysis) method.</p>
<p>In research from Gradojevic et al. (2020), it has been found that high frequency traders’ movements are supported by triangle arbitrage, which occurs in a millisecond trading environment. In their study, they used wavelet-based regression approach which allowed them to find 80-100 arbitrage opportunities in a day in Foreign Exchange (FX). Expectedly, these aberrations are brief, lasting between 100 and 500 milliseconds. The average profit ranged between 0.5 and 0.75 basis points. However, as mentioned earlier, the volatility in the cryptocurrency market is higher. In our model, we were able to detect 3 different arbitrage opportunities in one minute with much higher profit margins. The same study from Gradojevic et al. (2020) suggests that currencies with low cross-correlation with others tend to have higher profit rates in arbitrage opportunities. Additional research from Knif et al. (1995) used frequency-embedded spectral approach to investigate the connection between two European stock exchanges. They found the market dependence can be described in a manageable way by using multiscale resolution of stock market performance and volatility.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/Architecture.jpg"><img alt="_images/Architecture.jpg" src="_images/Architecture.jpg" /></a><br>
<strong>Figure 0</strong> - Architecture</p>
<section id="what-is-a-crypto-trading-arbitrage-bot">
<h3>What is a Crypto Trading/Arbitrage Bot?<a class="headerlink" href="#what-is-a-crypto-trading-arbitrage-bot" title="Permalink to this headline"></a></h3>
<p>Automated trading started in the 1980s. Since then, it has been used and developed by institutional investors and large trading firms for different purposes. It is also known as algorithmic trading by investors. Nowadays, algorithmic trading composes 60-70% of the total equity trades in the US market. It is 100% legal, and preferabed by users due to its ability for high frequency trading. The investors are able to trade 7/24 with the help of these computer programs without spending days and nights on their computers. Once they setup their parameters, the program is ready to execute trades on selected currencies. The first product invented for this purpose was Automated Trading Desk (ATD). MacKenzie (2016) explained that ATDs were primarily automated marketmakers in his research. They were invented to replace NYSE (New York Stock Exchange) specialists whose role was to buy an asset from a given price and sell it for a higher price. Nevertheless, relying on people makes this process slow, and it is very fragile against human mistakes. While ATDs make this process significantly faster and better, they are not considered as the official marketmakers.</p>
<p>Trading bots can be considered a type of ATDs. They are computer programs are programmed to automatically execute buy and sell orders on an exchange, based on a trading strategy. There are various service providers on the market, not just for trading, but for arbitrage trading as well. Users can either choose an in-built trading strategy or make their own with their favorite indicators and currency pairs. Arbitrage bots have the same concept as the trading bots, but their strategy is based on making profit from price differences. <em>For example, Pionex is a crypto trading bot provider which also offers arbitrage bot. Their system is based on opening a hedge position in perpetual futures market on people’s spot crypto positions. If a client has $1000 invested Ethereum (ETH) in spot, the bot opens a short position worth of $1000 on ETH-USDT pair. Since long position holders pay a funding fee to short position holders every 8 hours, their earnings and losses balances each other, but the earnings from funding fee is their profit. If the investors hold short positions more than the long positions, this strategy will not work. However, the funding rate (a ratio shows the balance between the long and short positions) is mostly positive, and this strategy can make money to the investors, especially in bullish market cycles.</em></p>
<p>Triangular arbitrage bots are slightly different than regular arbitrage bots because of the concept of triangular arbitrage. Rather than trading an asset in different exchanges, triangular arbitrage focuses on the selected three trading pairs and trades them in the same exchange. Multiple opportunities are created in crypto market for triangular arbitrage trading. Due to its high volatility and non-stop market structure, crypto currency market is a gem for most traders.</p>
<p>Triangular arbitrage works in the same logic as in foreign exchange market. It exploits from the market inefficiencies in crypto market. Below example explains how it works:</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/triangular.jpg"><img alt="_images/triangular.jpg" src="_images/triangular.jpg" /></a><br>
<strong>Figure 1</strong> - Triangular Arbitrage</p>
</section>
<section id="parameters-of-our-triangular-arbitrage-bot">
<h3>Parameters of Our Triangular Arbitrage Bot<a class="headerlink" href="#parameters-of-our-triangular-arbitrage-bot" title="Permalink to this headline"></a></h3>
<p>In this study, Kucoin exchange is used for analysis. Necessary API keys are generated to gather all the coins’ prices in Kucoin. At first, the coin prices were gathered for 5 minutes, and the analysis were made in this dataset. Taker, and maker fees are adjusted to 0.001 according to real fees applied in Kucoin. Fiat unit per trade is adjusted to 50 US Dollars. To avoid small profit margins, minimum percentage of profit margin to display is adjusted to 0.1%. This adjustment was necessary because smaller profit margins get lost by trading fees, and can cause the trader to lose money on trades. For that reason, any trade opportunity needs to have at least 0.1% to be executed. The model also calculates two different arbitrage opportunities for given three currencies. These are defined as forward arbitrage, and reverse arbitrage. The model executes the arbitrage opportunity with higher profit margin with the constraint of being more than 0.1%.</p>
</section>
</section>
<section id="dataset">
<h2>Dataset<a class="headerlink" href="#dataset" title="Permalink to this headline"></a></h2>
<p>In this study, the dataset is gathered from Kucoin exchange. Firstly, API keys are generated on Kucoin. Then, these API keys are used to gather data from the exchange. These API keys are also necessary to execute orders automatically. After generating API keys, they are put in the “<em>exchange</em>live.py” script to gather real-time trading data for all crypto currencies in Kucoin. The dataset consists of the pairs’ ticker, best ask price, best bid price, best ask trade size, best bid trade size, price, sequence, trade size, and timestamp. It is necessary to have the real time data to find triangular arbitrage opportunities. It is also necessary to have all the pairs in the exchange, so no opportunities can be missed.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/dataset.png"><img alt="_images/dataset.png" src="_images/dataset.png" /></a><br>
<strong>Figure 2</strong> - ETL dataset</p>
<section id="exploratory-data-analysis">
<h3>Exploratory data analysis<a class="headerlink" href="#exploratory-data-analysis" title="Permalink to this headline"></a></h3>
<p>The dataset contains all the trading pairs in the Kucoin exchange for a given time. There are 10 columns and 690 rows, meaning there are 690 trading pairs. From the 10 columns three of them have object data type and the others are float data type.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/describe.jpeg"><img alt="_images/describe.jpeg" src="_images/describe.jpeg" /></a><br>
<strong>Figure 3</strong> - Describe function exploration</p>
<p>BTC/TUSD has the highest price in this dataset. It is expected that Bitcoin has the highest price as leading and the first coin in crypto exchange. NFT/USDT trading pair has the biggest trading size in this dataset.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/sort.jpeg"><img alt="_images/sort.jpeg" src="_images/sort.jpeg" /></a><br>
<strong>Figure 4</strong> - Size column sort function exploration</p>
<p>When we analyzed the correlation between the columns, it was obvious that there was a positive correlation between bestbidSize and size columns. For all the trading pairs, it is understandable that the bidders increases the size of the total trades.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/bid-ask-size-correlation.jpeg"><img alt="_images/bid-ask-size-correlation.jpeg" src="_images/bid-ask-size-correlation.jpeg" /></a><br>
<strong>Figure 5</strong> - Correlation across bestbidSize and Size columns</p>
<p>Another interesting correlation is between Bitcoin’s price and trading size. While it was observed that there was negative correlation between these two, there was positive correlation between bestbidSize and the price. On the other hand, these correlations are positive for Ethereum’s trading pairs.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/btc-size-price-correlation.png"><img alt="_images/btc-size-price-correlation.png" src="_images/btc-size-price-correlation.png" /></a><br>
<strong>Figure 6</strong> - Correlation across BTC size and price</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/eth-size-price-correlation.png"><img alt="_images/eth-size-price-correlation.png" src="_images/eth-size-price-correlation.png" /></a><br>
<strong>Figure 7</strong> - Correlation across ETH size and price</p>
</section>
<section id="price-prediction-with-time-series-analysis">
<h3>Price Prediction with Time Series Analysis<a class="headerlink" href="#price-prediction-with-time-series-analysis" title="Permalink to this headline"></a></h3>
<p>In this study, we did time series analysis to have a better understanding of the price movements in crypto currencies. We used AUTOARIMA, SARIMAX, and LSTM models to analyze Bitcoin’s price movements in time. Since it is a highly volatile market, it is hard to predict the future price compared to other crypto currencies. Average true range is larger compared to regular stock exchange. Price prediction is important because arbitrage opportunities can be gone in seconds if the market is in a down trend. Even though the trades are executed very quickly, an instant drop in the Bitcoin’s price can take away the potential profits and cause the trader to lose money. Since, the crypto currencies’ prices are highly connected to each other, a price decrease in Bitcoin affects the entire market instantly. For that reason, this price analysis helps traders understand when to execute arbitrage trades. It is less risky to do arbitrage in an uptrend market.</p>
<p><strong>AUTOARIMA</strong>, Autoregressive Integrated Moving Average, model is used to better understand and forecast future trends. It is a statistical analysis model that uses time series data. It is autoregressive because it uses past values to predict future values. It is used in statistics and econometrics to track occurrences across time. In our study, our historically time series data is aggregated by the daily. Because of the viotility of the crypto market, as seen recently Luna and Terra, it is extremely difficult to predict future price point. For this reason, we only analyze large marketcap currencies for EDA/Time Series analysis such as BTC.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/AUTOARIMA-MAPE.jpeg"><img alt="_images/AUTOARIMA-MAPE.jpeg" src="_images/AUTOARIMA-MAPE.jpeg" /></a>
<strong>Figure 8</strong> - AUTOARIMA Model Construction and Parameters Setting - p d q value are automatically generated within the AUTOARIMA model.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/AUTOARIMA-chart-2.jpeg"><img alt="_images/AUTOARIMA-chart-2.jpeg" src="_images/AUTOARIMA-chart-2.jpeg" /></a>
<strong>Figure 9</strong> - AUTOARIMA Model - Model was constructed using data from 1/1/2022 through 5/13/2022. Data from 5/02/2022 through 5/13/2022 was without to evaulate performance.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/AUTOARIMA-scores.jpeg"><img alt="_images/AUTOARIMA-scores.jpeg" src="_images/AUTOARIMA-scores.jpeg" /></a>
<strong>Figure 10</strong> - AUTOARIMA MAPE Score - 3.79%</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/AUTOARIMA-chart-1.jpeg"><img alt="_images/AUTOARIMA-chart-1.jpeg" src="_images/AUTOARIMA-chart-1.jpeg" /></a>
<strong>Figure 11</strong> - AUTOARIMA Model Forecasting - 14 days into the Future, expecting a decrease in price.</p>
<p><strong>SARIMAX</strong>, Seasonal Autoregressive Integrated Moving Average, is another model which uses past data to better understand and predict future values. SARIMA model takes seasonal trends into consideration, which is the main difference from AUTOARIMA model. In our study, our historically time series data is aggregated daily. Because of the viotility of the crypto market, as seen recently Luna and Terra, it is extremely difficult to predict future price point. For this reason, we only analyze large marketcap currencies for EDA/Time Series analysis such as BTC.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/SARIMAX-scores.jpeg"><img alt="_images/SARIMAX-scores.jpeg" src="_images/SARIMAX-scores.jpeg" /></a><br>
<strong>Figure 12</strong> - SARIMAX Model Construction and Parameters Setting - p d q value are based on the lowest AIC score previously determined.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/SARIMAX-chart-1.jpeg"><img alt="_images/SARIMAX-chart-1.jpeg" src="_images/SARIMAX-chart-1.jpeg" /></a><br>
<strong>Figure 13</strong> - SARIMAX Model - Model was constructed using data from 1/1/2022 through 5/13/2022. Data from 5/02/2022 through 5/13/2022 was without to evaulate performance.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/SARIMAX-MAPE.jpeg"><img alt="_images/SARIMAX-MAPE.jpeg" src="_images/SARIMAX-MAPE.jpeg" /></a><br>
<strong>Figure 14</strong> - SARIMAX MAPE Score - 3.81%</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/SARIMAX-chart-2.jpeg"><img alt="_images/SARIMAX-chart-2.jpeg" src="_images/SARIMAX-chart-2.jpeg" /></a><br>
<strong>Figure 15</strong> - SARIMAX Model Forecasting - 14 days into the Future, expecting a decrease in price.</p>
<p><strong>LSTM</strong>, Long Short-Term Memory is based on the Recurrent Neural Network (RNN) architecture. It is widely used in Natural Language Processing along with time series analysis. Unlike traditional Recurrent Neural Networks, LSTM utilizes short-memory by using a series of gates, each which has it own Recurrent Neural Network. Based on the probabilistic model with the LSTM model manages the datapoints. When a prediction is made, it is fed back into the model in order to predict the next point within that sequence. Error is introduced with each new prediction. In order to aviod gradienting issues, values are manuplated through tanh and sigmoid activation function prior to entering and leaving the gate.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/LSTM.jpeg"><img alt="_images/LSTM.jpeg" src="_images/LSTM.jpeg" /></a><br>
<strong>Figure 16</strong> - LSTM Architecture</p>
<p>For the LSTM aspect, our historically time series data is aggregated by the minute range. Again, because of the viotility of the crypto market, we only analyze large marketcap currencies for EDA/Time Series analysis such as BTC.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/LSTM-chart-6.jpeg"><img alt="_images/LSTM-chart-6.jpeg" src="_images/LSTM-chart-6.jpeg" /></a><br>
<strong>Figure 17</strong> - Histogram - Understanding BTC Price Movement</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/LSTM-chart-5.jpeg"><img alt="_images/LSTM-chart-5.jpeg" src="_images/LSTM-chart-5.jpeg" /></a><br>
<strong>Figure 18</strong> - Historically Price Movement - BTC</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/LSTM-scores-2.jpeg"><img alt="_images/LSTM-scores-2.jpeg" src="_images/LSTM-scores-2.jpeg" /></a><br>
<strong>Figure 19</strong> - Histogram and QQ Plot</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/LSTM-scores-1.jpeg"><img alt="_images/LSTM-scores-1.jpeg" src="_images/LSTM-scores-1.jpeg" /></a><br>
<strong>Figure 20</strong> - High P value indicates poor model performance</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/LSTM-chart-4.jpeg"><img alt="_images/LSTM-chart-4.jpeg" src="_images/LSTM-chart-4.jpeg" /></a><br>
<strong>Figure 21</strong> - LSTM Model Construction</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/LSTM-chart-3.jpeg"><img alt="_images/LSTM-chart-3.jpeg" src="_images/LSTM-chart-3.jpeg" /></a><br>
<strong>Figure 22</strong> - Performance Metric Evaluation</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/LSTM-chart-2.jpeg"><img alt="_images/LSTM-chart-2.jpeg" src="_images/LSTM-chart-2.jpeg" /></a><br>
<strong>Figure 23</strong> - Epochs Over Loss - LSTM</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/LSTM-chart-1.jpeg"><img alt="_images/LSTM-chart-1.jpeg" src="_images/LSTM-chart-1.jpeg" /></a><br>
<strong>Figure 24</strong> - LSTM - Prediction Verus Actual</p>
</section>
</section>
<section id="how-does-our-bot-work">
<h2>How does our bot work?<a class="headerlink" href="#how-does-our-bot-work" title="Permalink to this headline"></a></h2>
<p>In this model there are multiple scripts generated for different purposes. In this section, we will dive into these scripts and explain how they work.</p>
<section id="kucoinlive-py">
<h3>Kucoinlive.py<a class="headerlink" href="#kucoinlive-py" title="Permalink to this headline"></a></h3>
<p>Firstly, configuration yaml is loaded and dictionary of setting is returned in this script. Then, log files are created with the date stamp added on each filename to clarify them for users. Kucoin API keys are entered here for data collection. After that, the real time coin price data are collected and saved in these log files. The data collected is also used to create tables. In these tables there is information about the coin’s best ask price, best bid price, best ask size, date stamp, etc. Below image is an example for these tables. Also monitors spot trades. Each and every change in account balance is displayed to have full knowledge on account balance. The changes and trades are stored in a database.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/tickers.png"><img alt="_images/tickers.png" src="_images/tickers.png" /></a><br>
<strong>Figure 25</strong> - kucoin.tickers table</p>
</section>
<section id="analysis-py">
<h3>Analysis.py<a class="headerlink" href="#analysis-py" title="Permalink to this headline"></a></h3>
<p>Trade opportunities are filtered depending on their profit rates in this script. The pairs are scanned in milliseconds for both forward and reverse trading opportunities. Trade opportunities with 0.1% or greater are going to be executed. Base ticker, quote ticker, best bid price, best ask price, best ask size, best bid size, price, sequence, size, and time columns of each opportunity are displayed. The trade opportunities which satisfy the constraints are executed in trade.py. This script includes both opportunities from triangular arbitrage, and bellman-ford optimization.</p>
</section>
<section id="trade-py">
<h3>Trade.py<a class="headerlink" href="#trade-py" title="Permalink to this headline"></a></h3>
<p>The opportunities detected in analysis.py are executed in this script. Trade opportunity with the greater profit rate between forward and reverse arbitrage is executed. If the profit rate is the same, forward arbitrage is executed. After every execution there is a print command “attempted” to continue processing next trade. Even if the opportunity is not executed, there is a print command “attempted”. Since the books have already changed, this action is neccessary to avoid losses, and leave that last trade behind.</p>
</section>
<section id="data-flow-for-this-project">
<h3>Data Flow for This Project<a class="headerlink" href="#data-flow-for-this-project" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/dataflow.jpg"><img alt="_images/dataflow.jpg" src="_images/dataflow.jpg" /></a><br>
<strong>Figure 26</strong> - Data Flow Diagram</p>
</section>
<section id="results-of-the-triangular-arbitrage-model">
<h3>Results of the Triangular Arbitrage Model<a class="headerlink" href="#results-of-the-triangular-arbitrage-model" title="Permalink to this headline"></a></h3>
<p>Our model was able to detect multiple trading opportunities in minutes with higher profit margin than 1%. Most opportunities have much higher profit than 1%. As you can see in the below image, the profit margins varies between 13% and 67%. The below image displays the pairs traded, trading size, trading price, forward arbitrage profit, and reverse arbitrage profit. Either forward arbitrage or reverse arbitrage shows ‘nan’ because whichever has higher profit the other is not considered as an opportunity.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/triangular-arbitrage-model-results.png"><img alt="_images/triangular-arbitrage-model-results.png" src="_images/triangular-arbitrage-model-results.png" /></a><br>
<strong>Figure 27</strong> - Triangular Arbitrage Model Results</p>
</section>
</section>
<section id="bellman-ford-algorithm">
<h2>Bellman-Ford Algorithm<a class="headerlink" href="#bellman-ford-algorithm" title="Permalink to this headline"></a></h2>
<p>The Bellman–Ford algorithm calculates the shortest routes in a weighted digraph from a single source vertex to all other vertices. It is a versatile algorithm which is capable of hangling graphs. Some time the edge weights can be negative numbers. If the sum of the edges are negative, it means that they are reachable from the source.
In this project, we used Bellman-Ford to detect arbitrage opportunities between different pairs. Our goal was to find the shortest trades to take advantage from the price discrepencies. Below image shows all the crypto currencies in Kucoin exchange with their trading pairs.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/graph.png"><img alt="_images/graph.jpg" src="_images/graph.jpg" /></a><br>
<strong>Figure 28</strong> - Bellman Ford Graph</p>
<p>We tried to find other arbitrage opportunities than using only three pairs. Triangular arbitrage allowed us to trade three pairs by taking advantage of the price difference between them. In this section we traded multiple pairs and use the arbitrage opportunities between them. However, more trades mean more fees. Thus, the profit margin would go down when the number of trades increase. For that reason, Bellman-Ford is useful because it finds the shortest path. Below image shows a few of the results we got by using Bellman-Ford algorithm. The trade path, trade type, trade size, trade rates, and profit margin can be seen in the image. As it can be seen in the image, our model found 8 opportunities in 12 minutes. Some of the profit margins are higher than 50%. For some of them, the dollar profit is not that high due to price change in milliseconds on the pairs, and the fees applied to execute the trades.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/Bellman-Ford-Model-results.png"><img alt="_images/Bellman-Ford-Model-results.png" src="_images/Bellman-Ford-Model-results.png" /></a><br>
<strong>Figure 29</strong> - Bellman Ford Model Results</p>
</section>
<section id="comparing-the-results-of-the-models">
<h2>Comparing the Results of the Models<a class="headerlink" href="#comparing-the-results-of-the-models" title="Permalink to this headline"></a></h2>
<p>After we finished our analysis, the results are compared between our models’ performances and the existing repositories on GitHub. For both triangular arbitrage model, and Bellman-Ford model our bots performed better than the existing models on GitHub. The opportunities our bots found had higher profit margin. The only caveat is that these trades were not executed in a production setting. It was only attempted in a sandbox environment with fake currency. Below, one can see the performance comparison with the maximum profit percentage achieved with both models.</p>
<p><a class="reference external" href="https://github.com/ehgp/realtime_crypto_arbitrage_bot/blob/main/docs/source/_static/result-model-comparison.png"><img alt="_images/result-model-comparison.png" src="_images/result-model-comparison.png" /></a><br>
<strong>Figure 30</strong> - Result Model Comparison of Performance</p>
</section>
<section id="conclusion-and-future-work">
<h2>Conclusion and Future Work<a class="headerlink" href="#conclusion-and-future-work" title="Permalink to this headline"></a></h2>
<p>In this study triangular arbitrage model, and Bellman-Ford model are selected to execute arbitrage trades in crypto currency market. Our results show they are both successful models which can help us execute profitable trades. As indicated in previous sections, our models performed better than the existing models found on GitHub. Both models were able to find multiple arbitrage options in minutes. The profit rates were always higher than 0.1%. For certain examples it was as high as 74%.</p>
<p>These trades were executed in sandbox environment with fake currency due to issues in Kucoin exchange. Trying these models in different exchanges like Gemini and Coinbase Pro can be one of the improvements for future work. Executing these arbitrage trades in a real exchange with real time data would be the best improvement for this project. Both models performed well according to our analysis, but it can be improved with additional market analysis. If users can confirm that the market is in an uptrend, arbitrage opportunities can be executed with less risk and more profit. For that reason, a model can be created to analyze and detect market trend. Lastly, executing arbitrage trades across multiple exchanges would be an important addition to this project.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline"></a></h2>
<p>Aloosh, A., &amp; Bekaert, G. (2017). Currency Factors. SSRN Electronic Journal. <a class="reference external" href="https://doi.org/10.2139/ssrn.3022623">https://doi.org/10.2139/ssrn.3022623</a></p>
<p>Gębarowski, R., Oświęcimka, P., Wątorek, M., &amp; Drożdż, S. (2019). Detecting correlations and triangular arbitrage opportunities in the Forex by means of multifractal detrended cross-correlations analysis. Nonlinear Dynamics, 98(3), 2349–2364. <a class="reference external" href="https://doi.org/10.1007/s11071-019-05335-5">https://doi.org/10.1007/s11071-019-05335-5</a></p>
<p><a class="reference external" href="https://github.com/calebpitts/CryptoArbitrageBot">https://github.com/calebpitts/CryptoArbitrageBot</a></p>
<p><a class="reference external" href="https://github.com/JinJis/arbitrage-bot">https://github.com/JinJis/arbitrage-bot</a></p>
<p><a class="reference external" href="https://github.com/rosshochwert/arbitrage">https://github.com/rosshochwert/arbitrage</a></p>
<p><a class="reference external" href="https://github.com/wardbradt/peregrine">https://github.com/wardbradt/peregrine</a></p>
<p>Gradojevic, N., Erdemlioglu, D., &amp; Gençay, R. (2020). A new wavelet-based ultra-high-frequency analysis of triangular currency arbitrage. Economic Modelling, 85, 57–73. <a class="reference external" href="https://doi.org/10.1016/j.econmod.2019.05.006">https://doi.org/10.1016/j.econmod.2019.05.006</a></p>
<p>Ito, T. (2012, November 15). Free Lunch! Arbitrage Opportunities in the Foreign Exchange Markets. NBER. <a class="reference external" href="https://www.nber.org/papers/w18541">https://www.nber.org/papers/w18541</a></p>
<p>Knif, J., Pynnönen, S., &amp; Luoma, M. (1995). An analysis of lead-lag structures using a frequency domain approach: Empirical evidence from the Finnish and Swedish stock markets. European Journal of Operational Research, 81(2), 259–270. <a class="reference external" href="https://doi.org/10.1016/0377-2217(93)e0321-n">https://doi.org/10.1016/0377-2217(93)e0321-n</a></p>
<p>Lin, A., Shang, P., &amp; Zhao, X. (2011). The cross-correlations of stock markets based on DCCA and time-delay DCCA. Nonlinear Dynamics, 67(1), 425–435. <a class="reference external" href="https://doi.org/10.1007/s11071-011-9991-8">https://doi.org/10.1007/s11071-011-9991-8</a></p>
<p>MacKenzie, D. (2016). A material political economy: Automated Trading Desk and price prediction in high-frequency trading. Social Studies of Science, 47(2), 172–194. <a class="reference external" href="https://doi.org/10.1177/0306312716676900">https://doi.org/10.1177/0306312716676900</a></p>
<p>Mushailov, J. (Iosif). (2021, March 31). LSTM Framework For Univariate Time-Series Prediction. Medium. <a class="reference external" href="https://towardsdatascience.com/lstm-framework-for-univariate-time-series-prediction-d9e7252699e">https://towardsdatascience.com/lstm-framework-for-univariate-time-series-prediction-d9e7252699e</a></p>
<p>Piccotti, L. R. (2018). Jumps, cojumps, and efficiency in the spot foreign exchange market. Journal of Banking &amp; Finance, 87, 49–67. <a class="reference external" href="https://doi.org/10.1016/j.jbankfin.2017.09.007">https://doi.org/10.1016/j.jbankfin.2017.09.007</a></p>
<p>What Is Triangular Arbitrage? (2021, November 8). Investopedia. <a class="reference external" href="https://www.investopedia.com/terms/t/triangulararbitrage.asp">https://www.investopedia.com/terms/t/triangulararbitrage.asp</a></p>
<p><a class="reference external" href="https://github.com/Kucoin/kucoin-python-sdk/issues/33">https://github.com/Kucoin/kucoin-python-sdk/issues/33</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Realtime Crypto Arbitrage Bot" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="user_guide.html" class="btn btn-neutral float-right" title="User Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 Erick Garcia, Daniel Abbasi, Yuksel Baris Dokuzoglu. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>